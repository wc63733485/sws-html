<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>我的产品</title>
		<script>
			var scale = 1/window.devicePixelRatio;
			document.write('<meta name="viewport" content="width=device-width,initial-scale='+scale+',minimum-scale='+scale+',maximum-scale='+scale+',user-scalable=no" />');
			var html = document.getElementsByTagName("html")[0];
		    var iWidth = html.getBoundingClientRect().width;
			html.style.fontSize = iWidth/15 +"px";
		</script>
		<link rel = 'stylesheet' href="css/reset.css" />
		<link rel="stylesheet" href="css/myproduct.css" />
	</head>
	<body onload="loaded()">
		<section id="wrap">
			<div id="scroller">
				<div id="pullDown" class=""><div class="pullDownLabel"></div></div>  
		        <div class="pulldown-tips">下拉刷新</div>  
				<ul class="project-list">
					<li>
						<div class="top">
							<img src="img/logo/bank1.png" />
							<div class="mid">
								<p>广发银行-月供贷</p>
								<p>
									<span>额度:10-50万</span>
									<span>还款:等额本息</span>
								</p>
								<p>
									<span>期限:1-5年</span>
									<span>时间:10-20天</span>
								</p>
							</div>
							<div class="right">
								<p>0.75%</p>
								<p>综合月息</p>
							</div>
						</div>
						<div class="down">
							<span>不上征信</span>
							<span>不用真实装修</span>
							<span>不看小额</span>
						</div>
					</li>
					<li>
						<div class="top">
							<img src="img/logo/bank2.png" />
							<div class="mid">
								<p>建设银行-月供贷</p>
								<p>
									<span>额度:10-50万</span>
									<span>还款:等额本息</span>
								</p>
								<p>
									<span>期限:1-5年</span>
									<span>时间:10-20天</span>
								</p>
							</div>
							<div class="right">
								<p>0.45%-0.75%</p>
								<p>综合月息</p>
							</div>
						</div>
						<div class="down">
							<span>不上征信</span>
							<span>不用真实装修</span>
							<span>不看小额</span>
						</div>
					</li>
					<li>
						<div class="top">
							<img src="img/logo/bank2.png" />
							<div class="mid">
								<p>建设银行-月供贷</p>
								<p>
									<span>额度:10-50万</span>
									<span>还款:等额本息</span>
								</p>
								<p>
									<span>期限:1-5年</span>
									<span>时间:10-20天</span>
								</p>
							</div>
							<div class="right">
								<p>0.3%-0.8%</p>
								<p>综合月息</p>
							</div>
						</div>
						<div class="down">
							<span>不上征信</span>
							<span>不用真实装修</span>
							<span>不看小额</span>
						</div>
					</li>
					<li>
						<div class="top">
							<img src="img/logo/bank2.png" />
							<div class="mid">
								<p>建设银行-月供贷</p>
								<p>
									<span>额度:10-50万</span>
									<span>还款:等额本息</span>
								</p>
								<p>
									<span>期限:1-5年</span>
									<span>时间:10-20天</span>
								</p>
							</div>
							<div class="right">
								<p>0.75%</p>
								<p>综合月息</p>
							</div>
						</div>
						<div class="down">
							<span>不上征信</span>
							<span>不用真实装修</span>
							<span>不看小额</span>
						</div>
					</li>
					<li>
						<div class="top">
							<img src="img/logo/bank2.png" />
							<div class="mid">
								<p>建设银行-月供贷</p>
								<p>
									<span>额度:10-50万</span>
									<span>还款:等额本息</span>
								</p>
								<p>
									<span>期限:1-5年</span>
									<span>时间:10-20天</span>
								</p>
							</div>
							<div class="right">
								<p>0.75%</p>
								<p>综合月息</p>
							</div>
						</div>
						<div class="down">
							<span>不上征信</span>
							<span>不用真实装修</span>
							<span>不看小额</span>
						</div>
					</li>
				</ul>
				 <div class="pullUp-tips"></div>  
				 <div id="pullUp" class="">  
		        	<div class="pullUpLabel"></div>  
		        </div>  
			</div>
		</section>
	</body>
	<script src="js/jquery-3.2.1.min.js"></script>
	<script src="js/iscroll.js"></script>
	<script src="js/iscroll-probe.js"></script>
	<script src="js/commo.js"></script>
	<script>
		$(".project-list").delegate('li','tap',function(e){
			e.stopPropagation();
			window.location.href = 'prodetialadvier.html';
		})
		function loaded () {  
        var myScroll,  
                    pullDown = $("#pullDown"),  
                    pullUp = $("#pullUp"),  
                    pullDownLabel = $(".pullDownLabel"),  
                    pullUpLabel = $(".pullUpLabel"),  
                    container = $('#list'),  
                    loadingStep = 0;//加载状态0默认，1显示加载状态，2执行加载数据，只有当为0时才能再次加载，这是防止过快拉动刷新  
  
            pullDown.hide();  
            pullUp.hide();  
  
            myScroll = new IScroll("#wrap", {  
                scrollbars: false,  
                mouseWheel: false,  
                interactiveScrollbars: true,  
                shrinkScrollbars: 'scale',  
                fadeScrollbars: true,  
                scrollY:true,  
                probeType: 2,  
                bindToWrapper:true  ,
                mouseWheel: true, 
                tap: true
            });  
            myScroll.on("scroll",function(){  
            	 console.log(this.y);
            	 console.log(loadingStep);
            	 console.log(pullDown.attr("class")) 
            	 console.log(pullUp.attr("class"))
                if(loadingStep == 0 && !pullDown.attr("class").match('refresh|loading') && !pullUp.attr("class").match('refresh')){  
                  if(this.y > 40){//下拉刷新操作
                        $(".pulldown-tips").hide();  
                        pullDown.addClass("refresh").show();  
                        pullDownLabel.text("松手刷新数据");  
                        loadingStep = 1;  
                        myScroll.refresh();  
                    }else if(this.y < (this.maxScrollY - 14)){//上拉加载更多  
                        pullUp.addClass("refresh").show();  
                        loadingStep = 1;  
                        if(currentPage==nextPage){
                        	console.log(1)
                        	 pullUp.attr('class','').show();
                        	 pullUpLabel.text("我是有底线的");
                        	 loadingStep = 0;
                        }else{
                        	pullUpLabel.text("松手加载数据")
                        	  pullUpAction();
                        	  myScroll.refresh();
                        }
                    }  
                }  
            });  
            myScroll.on("scrollEnd",function(){  
                if(loadingStep == 1){  
                    if( pullDown.attr("class").match("refresh") ){//下拉刷新操作  
                        pullDown.removeClass("refresh").addClass("loading");  
                        pullDownLabel.text("正在刷新");  
                        loadingStep = 2;  
                        pullDownAction();  
                    }
                }  
            });  
	        function pullDownAction(){  
	                pullDown.attr('class','').hide();
	                data.pageSize = 5;
	                console.log(data);
//	                getAjax(header+"/loanConsultantList.do",data);
	                myScroll.refresh();  
	                loadingStep = 0;  
	                $(".pulldown-tips").show();  
	        }
	        function pullUpAction(){
	        	  pullUp.attr('class','').hide();
	                if(currentPage!=nextPage ){
	                	 data.pageSize = pageSize + 3;
//	                	 getAjax(header+"/loanConsultantList.do",data);
	                }
	                myScroll.refresh();  
	                loadingStep = 0;  
	        }  
  
        document.addEventListener('touchmove', function (e) { e.preventDefault(); }, false);  
        }  
	</script>
</html>
